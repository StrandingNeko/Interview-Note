![image-20231228210422603](F:\8.ObsidianNote\5.System Structure\figures\image-20231228210422603.png)

1. QF：事件驱动框架，提供事件驱动的基础设施，用于执行活动对象并确保它们之间线程安全的事件驱动交换
2. QV：协作式内核
3. QK：抢占式非阻塞式内核
4. QXK：抢占式阻塞式RTOS内核
5. QS：软件跟踪系统，使开发人员能够以最小的目标系统资源监控实时事件驱动的QP™应用程序，而不会停止或显着减慢代码
6. QEP：事件处理器，实现分层状态机语义(基于UML状态图)。顶层是由松散耦合的活动对象组成的应用程序级代码。

![image-20231228210358305](F:\8.ObsidianNote\5.System Structure\figures\image-20231228210358305.png)

包和类的结构反映了分层的体系结构。QP框架提供了一些基类，以便在应用程序中进行子类化和专门化。这是大多数框架的一个非常常见的特点。该框架还使用底层内核或RTOS来实现基本的多任务处理和事件队列服务。

1. QHsm：用于派生特定于应用程序的 Hsm
2. QEvt：用于派生带有参数的特定于应用程序的事件或直接用于没有参数的事件
3. QTimeEvt：”按原样“用于时间事件或进一步派生子类为特定于应用程序的时间事件

![image-20231228210946072](F:\8.ObsidianNote\5.System Structure\figures\image-20231228210946072.png)

QEP支持以下状态机概念：

1. 分层状态嵌套
2. 状态中的进入/退出动作
3. 常规转换
4. 内部转换
5. 嵌套初始转换
6. 所有转换类型的保护条件

![image-20231228211026787](F:\8.ObsidianNote\5.System Structure\figures\image-20231228211026787.png)

活动对象框架的主要工作是为每个活动对象提供执行环境(线程)，并提供线程安全的异步机制来交换事件。

QF框架充当连接活动对象的“软件总线”。该框架支持直接事件发布以及发布-订阅事件交换。

![image-20231228211056113](F:\8.ObsidianNote\5.System Structure\figures\image-20231228211056113.png)

QP/C和QP/ c++框架支持“零拷贝”事件传递，用于交换带有任意参数的事件，其工作原理如下：

1. 应用程序从一个固定大小的事件池2中分配一个事件。
2. 应用程序向活动对象发布或发布事件。
3. AOs处理事件，而它们可以重新发布或重新发布事件4。
4. QP自动检测事件是否仍在使用，如果不是5则回收它。
5. 作为一种优化，QP支持不可变的“静态事件”。此类静态事件不需要动态分配和回收。